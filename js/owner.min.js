/* MenuLabus - Optimized */
function initOwnerTabs(){const t=document.querySelectorAll(".menu-tabs-container .tab-btn");t.forEach(e=>{e.addEventListener("click",function(e){e.preventDefault(),t.forEach(t=>t.classList.remove("active")),this.classList.add("active"),window.location.href=this.href})})}function initReportFilters(){const t=document.querySelector("select[name='period']");t&&t.addEventListener("change",function(){this.form.submit()})}function initCharts(){const t=document.getElementById("chartsContainer");t&&window.chartData&&0!==window.chartData.length?(t.innerHTML="",window.chartData.forEach((e,n)=>{const a=document.createElement("div");a.className="chart-container";const r=document.createElement("h3");r.className="chart-title",r.textContent=e.title;const o=document.createElement("div");o.className="chart-bars";const s=e.values.map(t=>{const e="string"==typeof t?parseFloat(t):t;return"number"!=typeof e||isNaN(e)?0:e}),c=Math.max(...s.filter(t=>t>0),1);e.values.forEach((t,a)=>{const r="string"==typeof t?parseFloat(t):t,s="number"!=typeof r||isNaN(r)?0:r,i=c>0?s/c*100:5,l=e.labels[a]||a+1,d=document.createElement("div");d.className="chart-bar",d.dataset.value=s,d.dataset.label=l,d.style.height=Math.max(i,20)+"%",d.style.backgroundColor=e.color||getDefaultColor(n);const h=document.createElement("span");h.className="chart-bar-value",h.textContent=formatValue(s);const u=document.createElement("span");u.className="chart-bar-label",u.textContent=formatLabel(l),d.appendChild(h),d.appendChild(u),o.appendChild(d)}),a.appendChild(r),a.appendChild(o),t.appendChild(a)}),document.querySelectorAll(".chart-bar").forEach(t=>{t.addEventListener("mouseenter",function(){this.style.transform="translateY(-8px) scale(1.08)",this.style.boxShadow="0 8px 20px rgba(0, 0, 0, 0.25)",this.style.zIndex="10"}),t.addEventListener("mouseleave",function(){this.style.transform="",this.style.boxShadow="",this.style.zIndex=""}),setTimeout(()=>{t.style.opacity="1",t.style.transform="translateY(0)"},100)})):t&&(t.innerHTML="<p>Нет данных для построения графиков</p>")}function getDefaultColor(t){const e=["#cd1719","#121212","#2c83c2","#4CAF50","#ff9321","#712121","#db3a34","#000000","#555555","#f9f9f9"];return e[t%e.length]}function formatValue(t){return"number"!=typeof t?String(t):t===Math.floor(t)?t.toString():t.toFixed(2)}function formatLabel(t){const e=String(t);return e.length>12?e.substring(0,10)+"...":e}function refreshReport(){const t=new URL(window.location.href),e=t.searchParams.get("report")||"sales",n=t.searchParams.get("period")||"day";fetch(`/api/report?report=${e}&period=${n}`).then(t=>t.json()).then(t=>{updateReportTable(t)}).catch(t=>{console.error("Error refreshing report:",t)})}function updateReportTable(t){}document.addEventListener("DOMContentLoaded",function(){initOwnerTabs(),initReportFilters(),initCharts()});