/* MenuLabus - Optimized */
!function(){"use strict";async function n(){return"granted"===Notification.permission||"granted"===await Notification.requestPermission()}async function t(n,t={}){try{const{phone:e=null,orderId:i=null}=t,a=await n.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:r("dGVzdC1wdWJsaWMta2V5LTE3NzAxOTMzMTI0NDI=")}),s=await fetch("/api/save-push-subscription.php",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({subscription:a,phone:e,order_id:i})}),o=await s.json();if(o.success)return a;throw new Error(o.error||"Ошибка сохранения подписки")}catch(n){return null}}function r(n){const t=(n+"=".repeat((4-n.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),r=window.atob(t),e=new Uint8Array(r.length);for(let n=0;n<r.length;++n)e[n]=r.charCodeAt(n);return e}"serviceWorker"in navigator&&"PushManager"in window&&(window.PushNotifications={init:async function(r={}){const e=await async function(){try{return await navigator.serviceWorker.register("/sw.js")}catch(n){return null}}();if(!e)return;if(!await n())return;return await e.pushManager.getSubscription()||await t(e,r)},subscribe:t,requestPermission:n},document.addEventListener("DOMContentLoaded",()=>{const n=window.pushSubscriptionData;n&&n.autoSubscribe}))}();